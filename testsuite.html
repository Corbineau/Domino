<!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Strict//EN" "http://www.w3.org/TR/xhtml1/DTD/xhtml1-strict.dtd"> 
<html xmlns="http://www.w3.org/1999/xhtml" xml:lang="en" lang="en" dir="ltr"> 

<head> 

<meta http-equiv="Content-Type" content="text/html; charset=utf-8" /> 

<link type="text/css" rel="stylesheet" media="all" href="domino.static.css" />
<link type="text/css" rel="stylesheet" media="all" href="stage.css" />

<script type="text/javascript" src="DominoGame.js"></script> 
<script type="text/javascript" src="DominoClient.js"></script> 
<script type="text/javascript" src="jquery-1.4.2.js"></script> 
<script type="text/javascript">
    $( function() {
    
        //test bed
        
        //create a new game server and shuffle and deal
        var gameServer = new Game();
        gameServer.shuffle();
        gameServer.deal();
        
        
        //this loop now simulates sending out player objects to each participating player
        //each players player object will contain all the information they need to participate
        //in the game
/*      for( var p = 0; p < gameServer.players.length; p++ ) {

            //create the player client object, and initialize it with the player cards
            //this should change to just accept the entire player object
            //this will likely come as json from the server
            //setup DominoClient to make ajax requests for its player information
            var client = new DominoClient(gameServer.players[p].cards);
            
            var cards = client.cards;
            
            for(var i = 0; i < cards.length; i++) {
            
                var card = client.createCard( cards[i].left(), cards[i].right());

                $("#players").append( card );
                
            }
        }
        */

        var client = new DominoClient();
        var a = gameServer.whichPlayer();
        gameServer.makePlay(a, new Game.Domino(6,6));

        var cc = 0;

        while(cc < 16)
        {
            a = gameServer.whichPlayer();
            ends = gameServer.headsAndTails();
            plays = gameServer.players[a].whatToPlay(ends.head, ends.tail);
            first = plays[0];
            var head = 0;
            if(first.right() == ends.head) head = 1;
            if(first.left() == ends.head) head = 1;
            left = first.left();
            right = first.right();
            dom = new Game.Domino(left, right);
            gameServer.makePlay(a, dom,head);
            cc += 1;
        }

        for(var ca = 0; ca < gameServer.playstack.length; ca++)
        {
            card = gameServer.playstack[ca];
            domcard = client.createCard(card);
            $("#players").append( domcard );
        }

    } );
    
</script>
</head>

<body>
    <div id="stage">
        <div id="players">
        </div>
    </div>
</body>
</html>
